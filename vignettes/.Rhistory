1000 * 6
1000 * 0.65
4 * 7
1.17 * 0.4
1.5 * 0.316190792
0.316190792 * 3.6
0.316190792 * 5.6
2.477011426 * 0.02
1000 * 5.5
650*0.6
650*0.6 * 1000
650*0.6 * 1000 * 0.1
knitr::opts_chunk$set(fig.width=6, fig.height=4)
options(width = 85)
setwd("~/GitHub/ABM/vignettes")
ff <- list.files('../R', full.names = TRUE)
for (i in ff) source(i)
out <- abm(365)
out0 <- abm(365)
out0 <- abm(365) # run the simulation for 365 days
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = 1, xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = 1, xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = 1, xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', legend = nn, ylab = 'Microbial biomass (kg)')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = "black", lwd = 1,
title = "Microbial biomass", cex = 0.8)
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Emission rate (kg/day)')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
legend("topright", legend = nn, lty = c(1:length(nn)), lwd = 1,
title = "Microbial biomass", cex = 0.8)
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Emission rate (kg/day)')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = line_colors, lwd = 1,
title = "Microbial biomass", cex = 0.8)
line_colors <- c('red', 'blue', 'green')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), col = line_colors, xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = line_colors, lwd = 1,
title = "Microbial biomass", cex = 0.8)
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = c(1:length(nn)), xlab = 'Time (d)', ylab = 'Emission rate (kg/day)')
line_colors <- c('red', 'blue', 'green')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), col = line_colors, xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = line_colors, lwd = 1,
title = "Microbial biomass", cex = 0.8)
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = c(1:length(nn)), col = line_colors, xlab = 'Time (d)', ylab = 'Emission rate (kg/day)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = line_colors, lwd = 1,
title = "Emission rates", cex = 0.8)
pigs <- 1000
CH4_pig_year <- max(out0$CH4_emis_cum)/1000/pigs
plot(slurry_mass/1000 ~ time, data = out0, type = 'l', xlab = 'Time (d)', ylab = 'Slurry mass (t)')
plot(temp_C ~ time, data = out0, type = 'l', xlab = 'Time (d)', ylab = 'Slurry mass (t)')
CH4_pig_year
pigs <- 1000
CH4_kg_pig_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/pigs
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/pigs
NH3_kg_pr_pig_pr_year
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/floor_area
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/area
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/out0$area
NH3_kg_pr_pig_pr_year
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/out0$area[1]
NH3_kg_pr_pig_pr_year
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
CO2_kg_pr_pig_pr_year <- max(out0$CO2_emis_cum)/1000/pigs
CO2_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/out0$area[1]
NH3_kg_pr_pig_pr_year
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
CO2_kg_pr_pig_pr_year <- max(out0$CO2_emis_cum)/1000/pigs
CO2_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/out0$area[1]
NH3_kg_pr_pig_pr_year
C_ratio <- (CH4_kg_pr_pig_pr_year * 12/16) / (CO2_kg_pr_pig_pr_year * 12/44)
C_ratio
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
CO2_kg_pr_pig_pr_year <- max(out0$CO2_emis_cum)/1000/pigs
CO2_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/out0$area[1]
NH3_kg_pr_pig_pr_year
C_ratio <- (CH4_kg_pr_pig_pr_year * 12/16) / (CO2_kg_pr_pig_pr_year * 12/44 + CH4_kg_pr_pig_pr_year * 12/16)
C_ratio
effluent_times <- out0$time[!is.na(out0$slurry_mass_eff)]
effluent_times
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
temp_dat <- read.csv('../dat/outside_slurry_temp.csv')
View(temp_dat)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ',')
View(temp_dat)
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = '\t')
abm()
View(temp_dat)
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
View(temp_dat)
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)')
View(temp_dat)
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)')
View(temp_dat)
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)', xlab = 'Time (days from 1. Apr)')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
slurry_mass_dat
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)', xlab = 'Time (days from 1. Apr)')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
slurry_mass_dat
VSd_fresh <- mean(out0$VSd_conc_eff)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)', xlab = 'Time (days from 1. Apr)')
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
slurry_mass_dat
VSd_fresh <- mean(out0$VSd_conc_eff)
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
VSd_fresh
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)', xlab = 'Time (days from 1. Apr)')
out1 <- abm(365, add_pars(slurry_mass = slurry_mass_dat, temp_C = temp_dat, conc_fresh.VSd = VSd_fresh, conc_fresh.urea = 0))
out1 <- abm(365, add_pars = list(slurry_mass = slurry_mass_dat, temp_C = temp_dat, conc_fresh.VSd = VSd_fresh, conc_fresh.urea = 0))
out1 <- abm(365, add_pars = list(slurry_mass = slurry_mass_dat, temp_C = temp_dat, conc_fresh.VSd = VSd_fresh, conc_fresh.urea = 0))
mol.carb <- alpha['VSd'] * y$VSd * 0.002753327
ff <- list.files('../R', full.names = TRUE)
for (i in ff) source(i)
out0 <- abm(365) # run the simulation for 365 days
ff <- list.files('../R', full.names = TRUE)
for (i in ff) source(i)
ff <- list.files('../R', full.names = TRUE)
for (i in ff) source(i)
out0 <- abm(365) # run the simulation for 365 days
line_colors <- c('red', 'blue', 'green')
matplot(out0$time, out0[, nn <- c('m0','m1','m2')]/1000,
type = 'l', lty = c(1:length(nn)), col = line_colors, xlab = 'Time (d)', ylab = 'Microbial biomass (kg)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = line_colors, lwd = 1,
title = "Microbial biomass", cex = 0.8)
matplot(out0$time, out0[, nn <- c('CH4_emis_rate', 'CO2_emis_rate', 'NH3_emis_rate')]/1000,
type = 'l', lty = c(1:length(nn)), col = line_colors, xlab = 'Time (d)', ylab = 'Emission rate (kg/day)')
legend("topright", legend = nn, lty = c(1:length(nn)), col = line_colors, lwd = 1,
title = "Emission rates", cex = 0.8)
pigs <- 1000
CH4_kg_pr_pig_pr_year <- max(out0$CH4_emis_cum)/1000/pigs
CH4_kg_pr_pig_pr_year
CO2_kg_pr_pig_pr_year <- max(out0$CO2_emis_cum)/1000/pigs
CO2_kg_pr_pig_pr_year
NH3_kg_pr_pig_pr_year <- max(out0$NH3_emis_cum)/1000/out0$area[1]
NH3_kg_pr_pig_pr_year
C_ratio <- (CH4_kg_pr_pig_pr_year * 12/16) / (CO2_kg_pr_pig_pr_year * 12/44 + CH4_kg_pr_pig_pr_year * 12/16)
C_ratio
effluent_times <- out0$time[out0$slurry_mass_eff != 0]
effluent_times
slurry_mass <- out0$slurry_mass_eff[out0$slurry_mass_eff != 0]
slurry_mass_dat <- data.frame(time = effluent_times, slurry_mass = slurry_mass)
slurry_mass_dat
VSd_fresh <- mean(out0$VSd_eff_conc, na.rm = T)
VSd_fresh
temp_dat <- read.csv('../dat/outside_slurry_temp.csv', sep = ';')
temp_dat
ff <- list.files('../R', full.names = TRUE)
for (i in ff) source(i)
out1 <- abm(365, add_pars = list(slurry_mass = slurry_mass_dat, temp_C = temp_dat, conc_fresh.VSd = VSd_fresh, conc_fresh.urea = 0))
y$VSd
alpha['VSd']
# if VSd is used. based on composition of degradable cattle manure excluding vfa (Appendix 1, ABM paper)
if(conc_fresh[['VSd']] > 1e-10){
mol.carb <- alpha['VSd'] * y$VSd * 0.002753327
mol.pro <- alpha['VSd'] * y$VSd * 0.00176104
mol.lip <- alpha['VSd'] * y$VSd * 9.902938e-05
}
mol.carb
mol.pro
mol.lip
alpha
y$VSd
y
alpha['VSd'] * y$VSd * 0.002753327
plot(slurry_mass_dat$time, slurry_mass_dat$slurry_mass, ylab = 'Slurry_mass (kg)', xlab = 'Time (days from 1. Apr)')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)', xlab = 'Time (days from 1. Apr)')
plot(slurry_mass_dat$time, slurry_mass_dat$slurry_mass, ylab = 'Slurry_mass (kg)',
xlab = 'Time (days from 1. Apr)')
plot(temp_dat$time, temp_dat$temp_C, ylab = 'Temperature (deg C)', xlab = 'Time (days from 1. Apr)')
